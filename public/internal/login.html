<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Login</title>
    <link rel="stylesheet" href="../css/main.css" type="text/css">
    <link rel="stylesheet" href="../css/internal/login.css" type="text/css">
  </head>
  <body>
    <div style="display: flex; flex-direction: row; align-items: center; width: 100%; justify-content: center;">
        <img src="../dragon.svg" id="dragon">
        <div style="width: 10px"></div>
        <h1>chs math bowl</h1>
    </div>
    <div id="container">
      <h2>LOG IN.</h2>
      <p id="message"></p>
      <input type="text" id="username" placeholder="Username">
      <input type="password" id="password" placeholder="Password">
      <a onclick="login()" id="submitbutton">Get Started Â»</a>
    </div>

    <script src="/__/firebase/7.5.0/firebase-app.js"></script>
    <script src="/__/firebase/7.5.0/firebase-auth.js"></script>
    <script src="/__/firebase/init.js"></script>
    <script>
      async function login() {
        let userCredential = await firebase.auth()
          .signInWithEmailAndPassword(
            document.getElementById("username").value + ".mathbowl@brandongong.org",
            document.getElementById("password").value)
          .catch(function(error) {
            if(error.code === "auth/user-not-found") {
              document.getElementById("message").innerHTML = "Your username does not exist."
              document.getElementById("username").focus();
            } else if(error.code === "auth/wrong-password") {
              if(document.getElementById("password").value === "") {
                document.getElementById("message").innerHTML = "Please enter a password."
              } else {
                document.getElementById("message").innerHTML = "Double-check that password is entered correctly."
              }
              document.getElementById("password").focus();
            }
          });
        if(userCredential !== undefined) {
          if(userCredential.user.email === "admin.mathbowl@brandongong.org") {
            window.location = "admin-console/index.html"
          } else {
            window.location = "dashboard/index.html";
          }
        }
      }
    </script>
  </body>
</html>
